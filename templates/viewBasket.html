<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>View Basket</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
	<script src="https://use.fontawesome.com/releases/v5.0.8/js/all.js"></script>
	<link href="style.css" rel="stylesheet">
	<link rel="shortcut icon" type="image/png" href="img/logo.png">
</head>
<body>

<!-- collapsable nav bar with icon -->
<nav class="navbar navbar-expand-md navbar-light bg-light sticky-top">
	<div class="container-fluid">
		<a class="navbar-brand" href="addItemToBasket.html"><img src="img/logo.png"></a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive">
		<span class="navbar-toggler-icon"></span>
	</button>
	<div class="collapse navbar-collapse" id="navbarResponsive">
		<ul class="navbar-nav ml-auto">
			<li class="nav-item">
				<a class="nav-link" href="addItemToBasket.html">Home</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" href="adminArea.html">Admin Area</a>
			</li>
			<li class="nav-item active">
				<a class="nav-link" href="viewBasket.html">View Basket</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" href="returnItems.html">Return Item</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" href="loginOrRegisterAccount.html">Logout</a>
			</li>
		</ul>
	</div>
	</div>
</nav>

<body>
<div class="container">
	<h2>Your Basket</h2>
	<br>
	<h4><ul>Your Credentials</ul></h4>

  </div>


  <style>
	table{
	  border-collapse: collapse;
	  width: 50%;
	  margin: auto;
	}
	td, th{
		border: 3px solid lightgrey;
		padding: 10px;
	}
	th{
		font-family: Arial, Verdana, sans-serif;
		font-weight: bold;
		text-shadow: 3px ;
	}
	.cost{
		width:20%;
		outline-width: 1px black;
	}
  
	tr:nth-child(odd){
		background-color: whitesmoke;
	}
	tr:hover{
	  background-color: pink;
		color: white;
	}
	</style>
  
	<script>
 	  window.onload = () => {
	  loadidData(idData);
	  totalPrice(BasketData2);	
	  display();
  };

	  let sortDirection = false;
	  let idData = [
	  { FullName: 'Elon Musk', Department: "Mars", Id: "420-dutty-bass-drop" }, 
  ];

   
  function loadidData(idData) {
	  const tableBody = document.getElementById('idData');
	  let dataHtml = '';
  
	  for(let id of idData) {
		  dataHtml += `<tr><td>${id.FullName}</td><td>${id.Department}</td><td>${id.Id}</td></tr>`;
	  };
	  console.log(dataHtml)
	  tableBody.innerHTML = dataHtml;
  };



  var BasketData2 = [
	  { "ProductId": "69-69", "ProductName": "200ml TestTubes", "Quantity": 3, "Price": 10.00 },
	  { "ProductId": "8==D", "ProductName": "deez nuts", "Quantity": 2, "Price": 50.00 },
	  { "ProductId": "KetSik1", "ProductName": "half a carrot", "Quantity": 1, "Price": 15 }, 
  ];



  function totalPrice(BasketData2) {
	const tableBody = document.getElementById('Cost');
	let cost = 0;

	for(let basket of BasketData2) {	
		cost += (basket.Price *basket.Quantity);
	  };
	  console.log(cost)
	  tableBody.innerHTML = cost;
	};


  
  function display() {
            var length = BasketData2.length;
            var htmltext = "";

            for (var i = 0; i < length; i++) {
                console.log(BasketData2[i]);
                htmltext += "<tr id='table"+i+"'><td>"
                +BasketData2[i].ProductId+
                "</td><td>"
                +BasketData2[i].ProductName+
                "</td><td>"
                +BasketData2[i].Quantity+
                "</td><td>"
                +BasketData2[i].Price+
                "</td><td><button onclick='edit("+i+")'>Edit</button><button onclick='remove("+i+")'>Remove</button></td></tr>";
            }
            document.getElementById("tbody").innerHTML = htmltext;
        }

		function edit(indice) {
            var htmltext = "<tr><td><input id='inputProductId"+indice+"' type='text' value='"
                +BasketData2[indice].ProductId+

                "'></td><td><input id='inputProductName"+indice+"' type='text' value='"
                +BasketData2[indice].ProductName+

                "'></td><td><input id='inputQuantity"+indice+"' type='text' value='"
                +BasketData2[indice].Quantity+

                "'></td><td><input id='inputPrice"+indice+"' type='text' value='"
                +BasketData2[indice].Price+

                "'></td><td><button onclick='save("+indice+")'>Save</button><button onclick='remove("+indice+")'>Remove</button></td></tr>";
            document.getElementById("table"+indice).innerHTML = htmltext;
        }

		function save(indice) {
            var values = new Array();

            //BasketData2[indice].ProductId = document.getElementById("inputProductId"+indice).value;
            values.push("'" + BasketData2[indice].ProductId[0].value + "'");

            BasketData2[indice].ProductName = document.getElementById("inputProductName"+indice).value;
            values.push("'" + BasketData2[indice].ProductName + "'");

            BasketData2[indice].Quantity = document.getElementById("inputQuantity"+indice).value;
            values.push("'" + BasketData2.Quantity + "'");
            
            BasketData2[indice].Price = document.getElementById("inputPrice"+indice).value;
            values.push("'" + BasketData2.Price + "'");

            console.log(values);
            /*push to database here*/

			totalPrice(BasketData2);

            var htmltext = "<tr id='table"+indice+"'><td>"
                +BasketData2[indice].ProductId+
                "</td><td>"
                +BasketData2[indice].ProductName+
                "</td><td>"
                +BasketData2[indice].Quantity+
                "</td><td>"
                +BasketData2[indice].Price+
                "</td><td><button onclick='edit("
                +indice+")'>Edit</button><button onclick='remove("
                +indice+")'>Remove</button></td></tr>";
            document.getElementById("table"+indice).innerHTML = htmltext;
        }


        function remove(indice) {
            console.log(BasketData2);
            BasketData2.splice(indice, 1);
			totalPrice(BasketData2);
            display();
        }
  

  </script>


  
  <table>
	  <thread>
		  <tr>
			<th>Full Name</th>
			<th>Department</th>
			<th>Id</th>   
		  </tr>
	  </thread>
	  <tbody id="idData"></tbody>
  </table>

  <div class="container">
  <h4><ul>Products in Basket</ul></h4>
  </div>

  <table>
	<thread>
		<tr>
		  <th>ProductId</th>
		  <th>ProductName</th>
		  <th>Price Per Item</th> 
		  <th>Quantity</th>  
		</tr>
	</thread>
	<tbody id="BasketData2"></tbody>
	<tbody id="tbody"></tbody>
</table>

<div class="container">
	<h4><ul>Total Cost</ul></h4>
	</div>

<table>
	<tbody id="Cost"></tbody>
</table>

<div class="container"><ul>
<input type="button" id="addButton" value="Complete Checkout" onclick="submit()" />
</ul></div>


<p>gets the total price of basket</p>
<p>could you make a nice box around the total cost</p>



</body>
</html>